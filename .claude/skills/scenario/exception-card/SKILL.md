---
name: scenario-exception-card
description: 管理例外卡，记录 Owner、范围、理由、到期与清理计划，确保临时豁免可追溯。
---

# 例外卡管理技能

## 适用场景
- 暂时豁免某条红线或质量门（如 lint 忽略、复杂度超限）。
- 需要记录、审批、跟踪例外并设定清理计划。
- 促进例外到期前的回收治理，避免永久化。

## 前置准备
- 获取团队例外卡模板（YAML）。
- 明确需要豁免的规则、影响范围、风险等级。
- 确认审批流程与 Owner。

## 操作步骤
1. **提出申请**
   - 填写 YAML：
     ```yaml
     owner: user.name
     scope: packages/foo/src/Bar.php
     reason: >
       说明例外原因及时效性。
     constraints:
       type: [TOLERATE: COMPLEXITY]
       expires_at: 2025-12-31
       cleanup_plan: |
         - 里程碑A：拆分函数
         - 里程碑B：补充测试
     notes: 影响面、回滚思路、监控项
     ```
   - 标注规则来源（`CLAUDE.md`、`tech/*`）。
2. **审批与登记**
   - 在团队知识库/Issue 注册，获取审批意见。
   - 将例外卡引用到相关 PR/任务，确保上下游知悉。
3. **执行与监控**
   - 在代码中添加注释或 TODO，引用例外卡 ID。
   - 定期检查到期时间，提前两周提醒 Owner。
4. **清理与关闭**
   - 完成清理计划：修复问题、移除忽略、恢复阈值。
   - 更新例外卡状态为 `resolved`，记录验证结果。

## 质量校验
- 例外卡信息完整：Owner、范围、理由、到期、清理计划。
- 关联任务与代码位置一一对应，便于追踪。
- 清理完成后有验证报告（质量门命令、测试结果）。

## 失败与回滚
- 未按期清理：升级为风险，纳入技术债治理会议。
- 理由不足/风险过高：拒绝例外，要求立即修复。
- 清理后出现回归：恢复例外状态但必须补充防护措施。

## 交付物
- 例外卡文档（YAML）与审批记录。
- 清理计划、执行结果、验证命令输出。
- 关闭记录，将经验写入技能或规范文档。
