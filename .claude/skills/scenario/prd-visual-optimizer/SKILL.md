---
name: scenario-prd-visual-optimizer
description: 当需要优化 PRD，使 Mermaid 图与表格双轨呈现并规避渲染陷阱时，请加载本技能。
allowed-tools: Read(*), Write(*), Edit(*), MultiEdit(*), Bash(*), Glob(*), Grep(*), TodoWrite
---

# PRD 优化与可视化技能

## 适用场景

- 需要将现有或新写的 PRD 进行重构，提升可读性与执行力。
- 针对包含 Mermaid 图的文档，避免渲染错误，确保图表与表格信息一致。
- 在需求范围、权限、测试等章节实现高度结构化输出。

## 前置准备

- 获取原始需求、用户角色、业务目标、非功能要求。
- 明确团队使用的模板（Markdown、飞书、Confluence 等）。
- 了解现有设计资源（线框图、接口文档）与测试策略。

## 操作步骤

1. **内容审计**
   - 梳理现有 PRD 结构：目标、范围、流程、角色、验收、风险。
   - 标注信息缺口（缺失指标、权限、验收标准等），向需求方提问补齐。
2. **双轨呈现**
   - **Mermaid 图**：流程/架构/状态图，遵循语法铁律（英文括号、单行语句、无 HTML 标签）。

     ```mermaid
     flowchart TD
       Start([Start]) --> Validate{输入校验}
       Validate -->|通过| Process[处理核心逻辑]
       Validate -->|失败| Reject[返回错误]
       Process --> End([End])
     ```

   - **结构化表格**：需求范围表、权限矩阵、接口清单，信息与图表一一对应。
3. **功能详述重构**
   - 用模块/场景/用户故事结构说明功能。
   - 指明输入、流程、输出、边界、异常处理。
   - 权限描述采用角色 × 操作矩阵，遵循最小权限。
4. **测试与验收**
   - 为每个需求提供可验证的测试策略：案例 ID、前置条件、步骤、期望结果。
   - 明确非功能指标（性能、稳定性、合规），提供测量方法。
5. **Mermaid 兼容校验**
   - 手动或脚本检查：英文标点、节点单行、无 Markdown 序号。
   - 在主流渲染器（Typora/Obsidian/GitLab）预览确认。
6. **格式审查**
   - 全文保持 Markdown 纯粹格式，无混合 HTML。
   - 统一标题层级、编号、引用。
   - 生成最终文档 + Mermaid 源文件，便于后续维护。

## 质量校验

- 需求范围图表与表格信息完全一致，互相引用。
- 权限、测试、非功能章节均具备执行指引与 Owner。
- Mermaid 图渲染 100% 成功，无中文括号或非法字符。
- PRD 内容可测试、可追溯，符合模板与格式要求。

## 失败与回滚

- 图表渲染失败：立即修正语法或拆分图表，重新校验。
- 信息缺失无法补齐：列出清单并标注责任人、截止时间。
- 权限或测试模糊：要求业务方/QA 提供补充说明。

## 交付物

- 优化后的 PRD Markdown 文档。
- Mermaid 图表源文件（.mmd）及渲染截图/SVG。
- 权限矩阵、测试计划表、风险清单。
