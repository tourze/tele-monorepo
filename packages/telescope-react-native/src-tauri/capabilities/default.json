{
  "$schema": "../gen/schemas/desktop-schema.json",
  "identifier": "default",
  "description": "Capability for the main window",
  "windows": ["main"],
  "permissions": [
    "core:default",
    "core:window:allow-set-title",
    "core:window:allow-hide",
    "core:window:allow-show",
    "core:window:allow-set-focus",
    "core:window:default",
    "fs:allow-app-meta-recursive",
    "fs:allow-app-read-recursive",
    "fs:allow-app-write-recursive",
    "fs:scope-app-recursive",
    "fs:scope-app-index",
    "fs:allow-appcache-meta-recursive",
    "fs:allow-appcache-read-recursive",
    "fs:allow-appcache-write-recursive",
    "fs:allow-appconfig-meta-recursive",
    "fs:allow-appconfig-read-recursive",
    "fs:allow-appconfig-write-recursive",
    "fs:allow-appdata-meta-recursive",
    "fs:allow-appdata-read-recursive",
    "fs:allow-appdata-write-recursive",
    "fs:allow-applocaldata-meta-recursive",
    "fs:allow-applocaldata-read-recursive",
    "fs:allow-applocaldata-write-recursive",
    "fs:allow-applog-meta-recursive",
    "fs:allow-applog-read-recursive",
    "fs:allow-applog-write-recursive",
    "fs:allow-cache-meta-recursive",
    "fs:allow-cache-read-recursive",
    "fs:allow-cache-write-recursive",
    "fs:allow-config-meta-recursive",
    "fs:allow-config-read-recursive",
    "fs:allow-config-write-recursive",
    "fs:allow-data-meta-recursive",
    "fs:allow-data-read-recursive",
    "fs:allow-data-write-recursive",
    "fs:allow-desktop-meta-recursive",
    "fs:allow-desktop-read-recursive",
    "fs:allow-desktop-write-recursive",
    "fs:allow-document-meta-recursive",
    "fs:allow-document-read-recursive",
    "fs:allow-document-write-recursive",
    "fs:allow-download-meta-recursive",
    "fs:allow-download-read-recursive",
    "fs:allow-download-write-recursive",
    "fs:allow-localdata-meta-recursive",
    "fs:allow-localdata-read-recursive",
    "fs:allow-localdata-write-recursive",
    "fs:allow-log-meta-recursive",
    "fs:allow-log-read-recursive",
    "fs:allow-log-write-recursive",
    "fs:allow-resource-meta-recursive",
    "fs:allow-resource-read-recursive",
    "fs:allow-resource-write-recursive",
    "fs:allow-temp-meta-recursive",
    "fs:allow-temp-read-recursive",
    "fs:allow-temp-write-recursive",
    "shell:allow-open",
    "shell:allow-kill",
    "shell:allow-spawn",
    {
      "identifier": "shell:allow-execute",
      "allow": [
        {
          "name": "sing-box",
          "cmd": "sing-box",
          "sidecar": true,
          "args": true
        },
        {
          "name": "taskkill",
          "cmd": "taskkill",
          "args": true
        },
        {
          "name": "tasklist",
          "cmd": "tasklist",
          "args": true
        },
        {
          "name": "nslookup",
          "cmd": "nslookup",
          "args": true
        },
        {
          "name": "cmd",
          "cmd": "cmd",
          "args": true
        },
        {
          "name": "hostname",
          "cmd": "hostname",
          "args": true
        },
        {
          "name": "powershell",
          "cmd": "powershell",
          "args": true
        },
        {
          "name": "wscript",
          "cmd": "wscript",
          "args": true
        },
        {
          "name": "dig",
          "cmd": "dig",
          "args": true
        },
        {
          "name": "ps",
          "cmd": "ps",
          "args": true
        },
        {
          "name": "ioreg",
          "cmd": "ioreg",
          "args": true
        },
        {
          "name": "bash",
          "cmd": "bash",
          "args": true
        },
        {
          "name": "sw_vers",
          "cmd": "sw_vers",
          "args": true
        },
        {
          "name": "scutil",
          "cmd": "scutil",
          "args": true
        },
        {
          "name": "system_profiler",
          "cmd": "system_profiler",
          "args": true
        },
        {
          "name": "osascript",
          "cmd": "osascript",
          "args": true
        },
        {
          "name": "ls",
          "cmd": "ls",
          "args": true
        },
        {
          "name": "launchctl",
          "cmd": "launchctl",
          "args": true
        }
      ]
    },
    {
      "identifier": "shell:allow-spawn",
      "allow": [
        {
          "name": "sing-box",
          "cmd": "sing-box",
          "sidecar": true,
          "args": true
        },
        {
          "name": "taskkill",
          "cmd": "taskkill",
          "args": true
        },
        {
          "name": "tasklist",
          "cmd": "tasklist",
          "args": true
        },
        {
          "name": "nslookup",
          "cmd": "nslookup",
          "args": true
        },
        {
          "name": "cmd",
          "cmd": "cmd",
          "args": true
        },
        {
          "name": "hostname",
          "cmd": "hostname",
          "args": true
        },
        {
          "name": "powershell",
          "cmd": "powershell",
          "args": true
        },
        {
          "name": "wscript",
          "cmd": "wscript",
          "args": true
        },
        {
          "name": "dig",
          "cmd": "dig",
          "args": true
        },
        {
          "name": "ps",
          "cmd": "ps",
          "args": true
        },
        {
          "name": "ioreg",
          "cmd": "ioreg",
          "args": true
        },
        {
          "name": "bash",
          "cmd": "bash",
          "args": true
        },
        {
          "name": "sw_vers",
          "cmd": "sw_vers",
          "args": true
        },
        {
          "name": "scutil",
          "cmd": "scutil",
          "args": true
        },
        {
          "name": "system_profiler",
          "cmd": "system_profiler",
          "args": true
        },
        {
          "name": "osascript",
          "cmd": "osascript",
          "args": true
        },
        {
          "name": "ls",
          "cmd": "ls",
          "args": true
        },
        {
          "name": "launchctl",
          "cmd": "launchctl",
          "args": true
        }
      ]
    },
    "store:default",
    "store:allow-get",
    "store:allow-set",
    "store:allow-save",
    "store:allow-load",
    "log:default",
    "os:default",
    "dialog:default",
    "notification:allow-is-permission-granted",
    "notification:allow-permission-state",
    "notification:allow-request-permission",
    "tsmanager:default",
    "tcp-ping:allow-tcping",
    "tcp-ping:allow-start-batch-ping",
    "tcp-ping:allow-stop-batch-ping",
    {
      "identifier": "http:default",
      "allow": [
        {
          "url": "https://*"
        },
        {
          "url": "http://*"
        },
        {
          "url": "https://**"
        },
        {
          "url": "http://**"
        },
        {
          "url": "https://*/*"
        },
        {
          "url": "http://*/*"
        },
        {
          "url": "http://127.0.0.1:*"
        },
        {
          "url": "http://127.0.0.1:*/*"
        }
      ]
    },
    "http:allow-fetch",
    "http:allow-fetch",
    "http:allow-fetch-cancel",
    "http:allow-fetch-read-body",
    "http:allow-fetch-send"
  ]
}
